<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Editar Excursión</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
    form { background: white; padding: 20px; border-radius: 8px; max-width: 600px; margin: auto; }
    label { display: block; margin-top: 10px; }
    input, textarea, select { width: 100%; padding: 8px; margin-top: 4px; }
    button { margin-top: 20px; padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background: #218838; }
  </style>
</head>
<body>
  <h2>Editar excursión existente</h2>
  <select id="excursion-selector"></select>
<form id="edit-form" action="https://script.google.com/macros/s/AKfycbzTHC6MZv-_dMOu40Ah1AdDHfPCHuNVoB8X3DpVEodWfAPipGkvBrsPMISrry6eBuJ0/exec" method="POST">
  <input type="hidden" name="rowIndex" id="rowIndex">
  <label>Nombre:<input type="text" name="name" id="name" required></label>
  <label>Descripción:<textarea name="description" id="description" required></textarea></label>
  <label>Categoría:<input type="text" name="category" id="category" required></label>
  <label>Precio:<input type="number" name="price" id="price" required></label>
  <label>Precio original:<input type="number" name="originalPrice" id="originalPrice"></label>
  <label>¿Recomendado?:<input type="text" name="recommended" id="recommended"></label>
  <label>Horario:<input type="text" name="schedule" id="schedule"></label>
  <label>Actividades:<input type="text" name="activities" id="activities"></label>
  <label>Latitud:<input type="text" name="origin_lat" id="origin_lat"></label>
  <label>Longitud:<input type="text" name="origin_lng" id="origin_lng"></label>
  <button type="submit">Guardar cambios</button>
</form>

  <script>
  const API_URL = 'https://script.google.com/macros/s/AKfycbzTHC6MZv-_dMOu40Ah1AdDHfPCHuNVoB8X3DpVEodWfAPipGkvBrsPMISrry6eBuJ0/exec';
  let excursions = [];

  fetch(API_URL)
    .then(res => res.json())
    .then(data => {
      excursions = data;
      const selector = document.getElementById('excursion-selector');
      selector.innerHTML = data.map((ex, i) =>
        `<option value="${i}">${ex.name}</option>`
      ).join('');
    });

  document.getElementById('excursion-selector').addEventListener('change', (e) => {
    const index = e.target.value;
    const excursion = excursions[index];

    document.getElementById('rowIndex').value = excursion.rowIndex;
    document.getElementById('name').value = excursion.name;
    document.getElementById('description').value = excursion.description;
    document.getElementById('category').value = excursion.category;
    document.getElementById('price').value = excursion.price;
    document.getElementById('originalPrice').value = excursion.originalPrice;
    document.getElementById('recommended').value = excursion.recommended;
    document.getElementById('schedule').value = excursion.schedule;
    document.getElementById('activities').value = excursion.activities;
    document.getElementById('origin_lat').value = excursion.origin_lat;
    document.getElementById('origin_lng').value = excursion.origin_lng;
  });
</script>
</body>
</html>